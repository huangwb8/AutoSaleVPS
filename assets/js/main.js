var ur=Object.defineProperty;var fr=(E,c,u)=>c in E?ur(E,c,{enumerable:!0,configurable:!0,writable:!0,value:u}):E[c]=u;var T=(E,c,u)=>fr(E,typeof c!="symbol"?c+"":c,u);class hr{constructor(c,u){T(this,"baseUrl");T(this,"nonce");this.baseUrl=c.replace(/\/$/,""),this.nonce=u}async request(c,u={}){const o=await fetch(`${this.baseUrl}/${c.replace(/^\//,"")}`,{headers:{"Content-Type":"application/json","X-WP-Nonce":this.nonce,...u.headers||{}},credentials:"same-origin",...u});if(!o.ok){const g=await o.text();throw new Error(g||"ËØ∑Ê±ÇÂ§±Ë¥•")}return o.status===204?{}:await o.json()}fetchConfig(){return this.request("/config")}saveConfig(c){return this.request("/config",{method:"POST",body:JSON.stringify({content:c})})}fetchModel(){return this.request("/model")}saveModel(c){return this.request("/model",{method:"POST",body:JSON.stringify({content:c})})}saveApiKey(c){return this.request("/key",{method:"POST",body:JSON.stringify({api_key:c})})}fetchVps(){return this.request("/vps")}fetchCachedVps(){return this.request("/vps/cached")}validateVps(c,u){return this.request("/vps/validate",{method:"POST",body:JSON.stringify({vendor:c,pid:u})})}refreshPromo(c,u){return this.request("/vps/promo",{method:"POST",body:JSON.stringify({vendor:c,pid:u})})}savePromo(c,u,o){return this.request("/vps/promo",{method:"POST",body:JSON.stringify({vendor:c,pid:u,content:o})})}refreshMeta(c,u){return this.request("/vps/meta",{method:"POST",body:JSON.stringify({vendor:c,pid:u})})}saveMeta(c,u,o){return this.request("/vps/meta",{method:"POST",body:JSON.stringify({vendor:c,pid:u,content:o})})}runDiagnostics(){return this.request("/diagnostics",{method:"POST"})}saveTimezone(c){return this.request("/timezone",{method:"POST",body:JSON.stringify({timezone:c})})}fetchExtraCss(){return this.request("/design")}saveExtraCss(c){return this.request("/design",{method:"POST",body:JSON.stringify({extra_css:c})})}}function dr(E){return E&&E.__esModule&&Object.prototype.hasOwnProperty.call(E,"default")?E.default:E}var pr=function(){function E(o,g){function s(){this.constructor=o}s.prototype=g.prototype,o.prototype=new s}function c(o,g,s,$,x,w){this.message=o,this.expected=g,this.found=s,this.offset=$,this.line=x,this.column=w,this.name="SyntaxError"}E(c,Error);function u(o){var g=arguments.length>1?arguments[1]:{},s={},$={start:dt},x=dt,w=function(){return Tt},n=s,V="#",te={type:"literal",value:"#",description:'"#"'},D=void 0,z={type:"any",description:"any character"},q="[",Z={type:"literal",value:"[",description:'"["'},U="]",C={type:"literal",value:"]",description:'"]"'},A=function(e){De(R("ObjectPath",e,I,j))},k=function(e){De(R("ArrayPath",e,I,j))},_=function(e,r){return e.concat(r)},Y=function(e){return[e]},F=function(e){return e},H=".",O={type:"literal",value:".",description:'"."'},Q="=",ee={type:"literal",value:"=",description:'"="'},qe=function(e,r){De(R("Assign",r,I,j,e))},Ot=function(e){return e.join("")},ze=function(e){return e.value},ae='"""',we={type:"literal",value:'"""',description:'"\\"\\"\\""'},ie=null,ve=function(e){return R("String",e.join(""),I,j)},be='"',Ae={type:"literal",value:'"',description:'"\\""'},ne="'''",Ee={type:"literal",value:"'''",description:`"'''"`},_e="'",ke={type:"literal",value:"'",description:`"'"`},Se=function(e){return e},Dt=function(e){return e},Ft="\\",It={type:"literal",value:"\\",description:'"\\\\"'},jt=function(){return""},Rt="e",qt={type:"literal",value:"e",description:'"e"'},zt="E",Ut={type:"literal",value:"E",description:'"E"'},Ht=function(e,r){return R("Float",parseFloat(e+"e"+r),I,j)},Jt=function(e){return R("Float",parseFloat(e),I,j)},Me="+",Ne={type:"literal",value:"+",description:'"+"'},Ue=function(e){return e.join("")},ce="-",ue={type:"literal",value:"-",description:'"-"'},He=function(e){return"-"+e.join("")},Kt=function(e){return R("Integer",parseInt(e,10),I,j)},Je="true",Zt={type:"literal",value:"true",description:'"true"'},Gt=function(){return R("Boolean",!0,I,j)},Ke="false",Xt={type:"literal",value:"false",description:'"false"'},Wt=function(){return R("Boolean",!1,I,j)},Yt=function(){return R("Array",[],I,j)},Qt=function(e){return R("Array",e?[e]:[],I,j)},es=function(e){return R("Array",e,I,j)},ts=function(e,r){return R("Array",e.concat(r),I,j)},Ze=function(e){return e},Ge=",",Xe={type:"literal",value:",",description:'","'},ss="{",rs={type:"literal",value:"{",description:'"{"'},is="}",as={type:"literal",value:"}",description:'"}"'},ns=function(e){return R("InlineTable",e,I,j)},We=function(e,r){return R("InlineTableValue",r,I,j,e)},ls=function(e){return"."+e},os=function(e){return e.join("")},fe=":",he={type:"literal",value:":",description:'":"'},Ye=function(e){return e.join("")},Qe="T",et={type:"literal",value:"T",description:'"T"'},cs="Z",us={type:"literal",value:"Z",description:'"Z"'},fs=function(e,r){return R("Date",new Date(e+"T"+r+"Z"),I,j)},hs=function(e,r){return R("Date",new Date(e+"T"+r),I,j)},ds=/^[ \t]/,ps={type:"class",value:"[ \\t]",description:"[ \\t]"},tt=`
`,st={type:"literal",value:`
`,description:'"\\n"'},gs="\r",ms={type:"literal",value:"\r",description:'"\\r"'},vs=/^[0-9a-f]/i,ys={type:"class",value:"[0-9a-f]i",description:"[0-9a-f]i"},$s=/^[0-9]/,Ps={type:"class",value:"[0-9]",description:"[0-9]"},xs="_",Cs={type:"literal",value:"_",description:'"_"'},ws=function(){return""},bs=/^[A-Za-z0-9_\-]/,As={type:"class",value:"[A-Za-z0-9_\\-]",description:"[A-Za-z0-9_\\-]"},Es=function(e){return e.join("")},rt='\\"',_s={type:"literal",value:'\\"',description:'"\\\\\\""'},ks=function(){return'"'},it="\\\\",Ss={type:"literal",value:"\\\\",description:'"\\\\\\\\"'},Ms=function(){return"\\"},at="\\b",Ns={type:"literal",value:"\\b",description:'"\\\\b"'},Ts=function(){return"\b"},nt="\\t",Bs={type:"literal",value:"\\t",description:'"\\\\t"'},Ls=function(){return"	"},lt="\\n",Vs={type:"literal",value:"\\n",description:'"\\\\n"'},Os=function(){return`
`},ot="\\f",Ds={type:"literal",value:"\\f",description:'"\\\\f"'},Fs=function(){return"\f"},ct="\\r",Is={type:"literal",value:"\\r",description:'"\\\\r"'},js=function(){return"\r"},ut="\\U",Rs={type:"literal",value:"\\U",description:'"\\\\U"'},ft=function(e){return or(e.join(""))},ht="\\u",qs={type:"literal",value:"\\u",description:'"\\\\u"'},t=0,P=0,de=0,Te={line:1,column:1,seenCR:!1},ye=0,Be=[],d=0,p={},$e;if("startRule"in g){if(!(g.startRule in $))throw new Error(`Can't start parsing from rule "`+g.startRule+'".');x=$[g.startRule]}function I(){return Le(P).line}function j(){return Le(P).column}function Le(e){function r(i,a,l){var f,h;for(f=a;f<l;f++)h=o.charAt(f),h===`
`?(i.seenCR||i.line++,i.column=1,i.seenCR=!1):h==="\r"||h==="\u2028"||h==="\u2029"?(i.line++,i.column=1,i.seenCR=!0):(i.column++,i.seenCR=!1)}return de!==e&&(de>e&&(de=0,Te={line:1,column:1,seenCR:!1}),r(Te,de,e),de=e),Te}function m(e){t<ye||(t>ye&&(ye=t,Be=[]),Be.push(e))}function zs(e,r,i){function a(v){var b=1;for(v.sort(function(N,S){return N.description<S.description?-1:N.description>S.description?1:0});b<v.length;)v[b-1]===v[b]?v.splice(b,1):b++}function l(v,b){function N(oe){function se(K){return K.charCodeAt(0).toString(16).toUpperCase()}return oe.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(K){return"\\x0"+se(K)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(K){return"\\x"+se(K)}).replace(/[\u0180-\u0FFF]/g,function(K){return"\\u0"+se(K)}).replace(/[\u1080-\uFFFF]/g,function(K){return"\\u"+se(K)})}var S=new Array(v.length),B,L,J;for(J=0;J<v.length;J++)S[J]=v[J].description;return B=v.length>1?S.slice(0,-1).join(", ")+" or "+S[v.length-1]:S[0],L=b?'"'+N(b)+'"':"end of input","Expected "+B+" but "+L+" found."}var f=Le(i),h=i<o.length?o.charAt(i):null;return r!==null&&a(r),new c(l(r,h),r,h,i,f.line,f.column)}function dt(){var e,r,i,a=t*49+0,l=p[a];if(l)return t=l.nextPos,l.result;for(e=t,r=[],i=pt();i!==s;)r.push(i),i=pt();return r!==s&&(P=e,r=w()),e=r,p[a]={nextPos:t,result:e},e}function pt(){var e,r,i,a,l,f,h,v=t*49+1,b=p[v];if(b)return t=b.nextPos,b.result;for(e=t,r=[],i=y();i!==s;)r.push(i),i=y();if(r!==s)if(i=Us(),i!==s){for(a=[],l=y();l!==s;)a.push(l),l=y();if(a!==s){for(l=[],f=Pe();f!==s;)l.push(f),f=Pe();if(l!==s){if(f=[],h=X(),h!==s)for(;h!==s;)f.push(h),h=X();else f=n;f===s&&(f=Ce()),f!==s?(r=[r,i,a,l,f],e=r):(t=e,e=n)}else t=e,e=n}else t=e,e=n}else t=e,e=n;else t=e,e=n;if(e===s){if(e=t,r=[],i=y(),i!==s)for(;i!==s;)r.push(i),i=y();else r=n;if(r!==s){if(i=[],a=X(),a!==s)for(;a!==s;)i.push(a),a=X();else i=n;i===s&&(i=Ce()),i!==s?(r=[r,i],e=r):(t=e,e=n)}else t=e,e=n;e===s&&(e=X())}return p[v]={nextPos:t,result:e},e}function Us(){var e,r=t*49+2,i=p[r];return i?(t=i.nextPos,i.result):(e=Pe(),e===s&&(e=Hs(),e===s&&(e=Js(),e===s&&(e=Ks()))),p[r]={nextPos:t,result:e},e)}function Pe(){var e,r,i,a,l,f,h=t*49+3,v=p[h];if(v)return t=v.nextPos,v.result;if(e=t,o.charCodeAt(t)===35?(r=V,t++):(r=s,d===0&&m(te)),r!==s){for(i=[],a=t,l=t,d++,f=X(),f===s&&(f=Ce()),d--,f===s?l=D:(t=l,l=n),l!==s?(o.length>t?(f=o.charAt(t),t++):(f=s,d===0&&m(z)),f!==s?(l=[l,f],a=l):(t=a,a=n)):(t=a,a=n);a!==s;)i.push(a),a=t,l=t,d++,f=X(),f===s&&(f=Ce()),d--,f===s?l=D:(t=l,l=n),l!==s?(o.length>t?(f=o.charAt(t),t++):(f=s,d===0&&m(z)),f!==s?(l=[l,f],a=l):(t=a,a=n)):(t=a,a=n);i!==s?(r=[r,i],e=r):(t=e,e=n)}else t=e,e=n;return p[h]={nextPos:t,result:e},e}function Hs(){var e,r,i,a,l,f,h=t*49+4,v=p[h];if(v)return t=v.nextPos,v.result;if(e=t,o.charCodeAt(t)===91?(r=q,t++):(r=s,d===0&&m(Z)),r!==s){for(i=[],a=y();a!==s;)i.push(a),a=y();if(i!==s)if(a=gt(),a!==s){for(l=[],f=y();f!==s;)l.push(f),f=y();l!==s?(o.charCodeAt(t)===93?(f=U,t++):(f=s,d===0&&m(C)),f!==s?(P=e,r=A(a),e=r):(t=e,e=n)):(t=e,e=n)}else t=e,e=n;else t=e,e=n}else t=e,e=n;return p[h]={nextPos:t,result:e},e}function Js(){var e,r,i,a,l,f,h,v,b=t*49+5,N=p[b];if(N)return t=N.nextPos,N.result;if(e=t,o.charCodeAt(t)===91?(r=q,t++):(r=s,d===0&&m(Z)),r!==s)if(o.charCodeAt(t)===91?(i=q,t++):(i=s,d===0&&m(Z)),i!==s){for(a=[],l=y();l!==s;)a.push(l),l=y();if(a!==s)if(l=gt(),l!==s){for(f=[],h=y();h!==s;)f.push(h),h=y();f!==s?(o.charCodeAt(t)===93?(h=U,t++):(h=s,d===0&&m(C)),h!==s?(o.charCodeAt(t)===93?(v=U,t++):(v=s,d===0&&m(C)),v!==s?(P=e,r=k(l),e=r):(t=e,e=n)):(t=e,e=n)):(t=e,e=n)}else t=e,e=n;else t=e,e=n}else t=e,e=n;else t=e,e=n;return p[b]={nextPos:t,result:e},e}function gt(){var e,r,i,a=t*49+6,l=p[a];if(l)return t=l.nextPos,l.result;if(e=t,r=[],i=vt(),i!==s)for(;i!==s;)r.push(i),i=vt();else r=n;return r!==s?(i=mt(),i!==s?(P=e,r=_(r,i),e=r):(t=e,e=n)):(t=e,e=n),e===s&&(e=t,r=mt(),r!==s&&(P=e,r=Y(r)),e=r),p[a]={nextPos:t,result:e},e}function mt(){var e,r,i,a,l,f=t*49+7,h=p[f];if(h)return t=h.nextPos,h.result;for(e=t,r=[],i=y();i!==s;)r.push(i),i=y();if(r!==s)if(i=pe(),i!==s){for(a=[],l=y();l!==s;)a.push(l),l=y();a!==s?(P=e,r=F(i),e=r):(t=e,e=n)}else t=e,e=n;else t=e,e=n;if(e===s){for(e=t,r=[],i=y();i!==s;)r.push(i),i=y();if(r!==s)if(i=Ve(),i!==s){for(a=[],l=y();l!==s;)a.push(l),l=y();a!==s?(P=e,r=F(i),e=r):(t=e,e=n)}else t=e,e=n;else t=e,e=n}return p[f]={nextPos:t,result:e},e}function vt(){var e,r,i,a,l,f,h,v=t*49+8,b=p[v];if(b)return t=b.nextPos,b.result;for(e=t,r=[],i=y();i!==s;)r.push(i),i=y();if(r!==s)if(i=pe(),i!==s){for(a=[],l=y();l!==s;)a.push(l),l=y();if(a!==s)if(o.charCodeAt(t)===46?(l=H,t++):(l=s,d===0&&m(O)),l!==s){for(f=[],h=y();h!==s;)f.push(h),h=y();f!==s?(P=e,r=F(i),e=r):(t=e,e=n)}else t=e,e=n;else t=e,e=n}else t=e,e=n;else t=e,e=n;if(e===s){for(e=t,r=[],i=y();i!==s;)r.push(i),i=y();if(r!==s)if(i=Ve(),i!==s){for(a=[],l=y();l!==s;)a.push(l),l=y();if(a!==s)if(o.charCodeAt(t)===46?(l=H,t++):(l=s,d===0&&m(O)),l!==s){for(f=[],h=y();h!==s;)f.push(h),h=y();f!==s?(P=e,r=F(i),e=r):(t=e,e=n)}else t=e,e=n;else t=e,e=n}else t=e,e=n;else t=e,e=n}return p[v]={nextPos:t,result:e},e}function Ks(){var e,r,i,a,l,f,h=t*49+9,v=p[h];if(v)return t=v.nextPos,v.result;if(e=t,r=pe(),r!==s){for(i=[],a=y();a!==s;)i.push(a),a=y();if(i!==s)if(o.charCodeAt(t)===61?(a=Q,t++):(a=s,d===0&&m(ee)),a!==s){for(l=[],f=y();f!==s;)l.push(f),f=y();l!==s?(f=le(),f!==s?(P=e,r=qe(r,f),e=r):(t=e,e=n)):(t=e,e=n)}else t=e,e=n;else t=e,e=n}else t=e,e=n;if(e===s)if(e=t,r=Ve(),r!==s){for(i=[],a=y();a!==s;)i.push(a),a=y();if(i!==s)if(o.charCodeAt(t)===61?(a=Q,t++):(a=s,d===0&&m(ee)),a!==s){for(l=[],f=y();f!==s;)l.push(f),f=y();l!==s?(f=le(),f!==s?(P=e,r=qe(r,f),e=r):(t=e,e=n)):(t=e,e=n)}else t=e,e=n;else t=e,e=n}else t=e,e=n;return p[h]={nextPos:t,result:e},e}function pe(){var e,r,i,a=t*49+10,l=p[a];if(l)return t=l.nextPos,l.result;if(e=t,r=[],i=Mt(),i!==s)for(;i!==s;)r.push(i),i=Mt();else r=n;return r!==s&&(P=e,r=Ot(r)),e=r,p[a]={nextPos:t,result:e},e}function Ve(){var e,r,i=t*49+11,a=p[i];return a?(t=a.nextPos,a.result):(e=t,r=yt(),r!==s&&(P=e,r=ze(r)),e=r,e===s&&(e=t,r=$t(),r!==s&&(P=e,r=ze(r)),e=r),p[i]={nextPos:t,result:e},e)}function le(){var e,r=t*49+12,i=p[r];return i?(t=i.nextPos,i.result):(e=Zs(),e===s&&(e=ar(),e===s&&(e=Ys(),e===s&&(e=Qs(),e===s&&(e=er(),e===s&&(e=tr(),e===s&&(e=sr())))))),p[r]={nextPos:t,result:e},e)}function Zs(){var e,r=t*49+13,i=p[r];return i?(t=i.nextPos,i.result):(e=Gs(),e===s&&(e=yt(),e===s&&(e=Xs(),e===s&&(e=$t()))),p[r]={nextPos:t,result:e},e)}function Gs(){var e,r,i,a,l,f=t*49+14,h=p[f];if(h)return t=h.nextPos,h.result;if(e=t,o.substr(t,3)===ae?(r=ae,t+=3):(r=s,d===0&&m(we)),r!==s)if(i=X(),i===s&&(i=ie),i!==s){for(a=[],l=Ct();l!==s;)a.push(l),l=Ct();a!==s?(o.substr(t,3)===ae?(l=ae,t+=3):(l=s,d===0&&m(we)),l!==s?(P=e,r=ve(a),e=r):(t=e,e=n)):(t=e,e=n)}else t=e,e=n;else t=e,e=n;return p[f]={nextPos:t,result:e},e}function yt(){var e,r,i,a,l=t*49+15,f=p[l];if(f)return t=f.nextPos,f.result;if(e=t,o.charCodeAt(t)===34?(r=be,t++):(r=s,d===0&&m(Ae)),r!==s){for(i=[],a=Pt();a!==s;)i.push(a),a=Pt();i!==s?(o.charCodeAt(t)===34?(a=be,t++):(a=s,d===0&&m(Ae)),a!==s?(P=e,r=ve(i),e=r):(t=e,e=n)):(t=e,e=n)}else t=e,e=n;return p[l]={nextPos:t,result:e},e}function Xs(){var e,r,i,a,l,f=t*49+16,h=p[f];if(h)return t=h.nextPos,h.result;if(e=t,o.substr(t,3)===ne?(r=ne,t+=3):(r=s,d===0&&m(Ee)),r!==s)if(i=X(),i===s&&(i=ie),i!==s){for(a=[],l=wt();l!==s;)a.push(l),l=wt();a!==s?(o.substr(t,3)===ne?(l=ne,t+=3):(l=s,d===0&&m(Ee)),l!==s?(P=e,r=ve(a),e=r):(t=e,e=n)):(t=e,e=n)}else t=e,e=n;else t=e,e=n;return p[f]={nextPos:t,result:e},e}function $t(){var e,r,i,a,l=t*49+17,f=p[l];if(f)return t=f.nextPos,f.result;if(e=t,o.charCodeAt(t)===39?(r=_e,t++):(r=s,d===0&&m(ke)),r!==s){for(i=[],a=xt();a!==s;)i.push(a),a=xt();i!==s?(o.charCodeAt(t)===39?(a=_e,t++):(a=s,d===0&&m(ke)),a!==s?(P=e,r=ve(i),e=r):(t=e,e=n)):(t=e,e=n)}else t=e,e=n;return p[l]={nextPos:t,result:e},e}function Pt(){var e,r,i,a=t*49+18,l=p[a];return l?(t=l.nextPos,l.result):(e=Nt(),e===s&&(e=t,r=t,d++,o.charCodeAt(t)===34?(i=be,t++):(i=s,d===0&&m(Ae)),d--,i===s?r=D:(t=r,r=n),r!==s?(o.length>t?(i=o.charAt(t),t++):(i=s,d===0&&m(z)),i!==s?(P=e,r=Se(i),e=r):(t=e,e=n)):(t=e,e=n)),p[a]={nextPos:t,result:e},e)}function xt(){var e,r,i,a=t*49+19,l=p[a];return l?(t=l.nextPos,l.result):(e=t,r=t,d++,o.charCodeAt(t)===39?(i=_e,t++):(i=s,d===0&&m(ke)),d--,i===s?r=D:(t=r,r=n),r!==s?(o.length>t?(i=o.charAt(t),t++):(i=s,d===0&&m(z)),i!==s?(P=e,r=Se(i),e=r):(t=e,e=n)):(t=e,e=n),p[a]={nextPos:t,result:e},e)}function Ct(){var e,r,i,a=t*49+20,l=p[a];return l?(t=l.nextPos,l.result):(e=Nt(),e===s&&(e=Ws(),e===s&&(e=t,r=t,d++,o.substr(t,3)===ae?(i=ae,t+=3):(i=s,d===0&&m(we)),d--,i===s?r=D:(t=r,r=n),r!==s?(o.length>t?(i=o.charAt(t),t++):(i=s,d===0&&m(z)),i!==s?(P=e,r=Dt(i),e=r):(t=e,e=n)):(t=e,e=n))),p[a]={nextPos:t,result:e},e)}function Ws(){var e,r,i,a,l,f=t*49+21,h=p[f];if(h)return t=h.nextPos,h.result;if(e=t,o.charCodeAt(t)===92?(r=Ft,t++):(r=s,d===0&&m(It)),r!==s)if(i=X(),i!==s){for(a=[],l=St();l!==s;)a.push(l),l=St();a!==s?(P=e,r=jt(),e=r):(t=e,e=n)}else t=e,e=n;else t=e,e=n;return p[f]={nextPos:t,result:e},e}function wt(){var e,r,i,a=t*49+22,l=p[a];return l?(t=l.nextPos,l.result):(e=t,r=t,d++,o.substr(t,3)===ne?(i=ne,t+=3):(i=s,d===0&&m(Ee)),d--,i===s?r=D:(t=r,r=n),r!==s?(o.length>t?(i=o.charAt(t),t++):(i=s,d===0&&m(z)),i!==s?(P=e,r=Se(i),e=r):(t=e,e=n)):(t=e,e=n),p[a]={nextPos:t,result:e},e)}function Ys(){var e,r,i,a,l=t*49+23,f=p[l];return f?(t=f.nextPos,f.result):(e=t,r=bt(),r===s&&(r=Oe()),r!==s?(o.charCodeAt(t)===101?(i=Rt,t++):(i=s,d===0&&m(qt)),i===s&&(o.charCodeAt(t)===69?(i=zt,t++):(i=s,d===0&&m(Ut))),i!==s?(a=Oe(),a!==s?(P=e,r=Ht(r,a),e=r):(t=e,e=n)):(t=e,e=n)):(t=e,e=n),e===s&&(e=t,r=bt(),r!==s&&(P=e,r=Jt(r)),e=r),p[l]={nextPos:t,result:e},e)}function bt(){var e,r,i,a,l,f,h=t*49+24,v=p[h];return v?(t=v.nextPos,v.result):(e=t,o.charCodeAt(t)===43?(r=Me,t++):(r=s,d===0&&m(Ne)),r===s&&(r=ie),r!==s?(i=t,a=ge(),a!==s?(o.charCodeAt(t)===46?(l=H,t++):(l=s,d===0&&m(O)),l!==s?(f=ge(),f!==s?(a=[a,l,f],i=a):(t=i,i=n)):(t=i,i=n)):(t=i,i=n),i!==s?(P=e,r=Ue(i),e=r):(t=e,e=n)):(t=e,e=n),e===s&&(e=t,o.charCodeAt(t)===45?(r=ce,t++):(r=s,d===0&&m(ue)),r!==s?(i=t,a=ge(),a!==s?(o.charCodeAt(t)===46?(l=H,t++):(l=s,d===0&&m(O)),l!==s?(f=ge(),f!==s?(a=[a,l,f],i=a):(t=i,i=n)):(t=i,i=n)):(t=i,i=n),i!==s?(P=e,r=He(i),e=r):(t=e,e=n)):(t=e,e=n)),p[h]={nextPos:t,result:e},e)}function Qs(){var e,r,i=t*49+25,a=p[i];return a?(t=a.nextPos,a.result):(e=t,r=Oe(),r!==s&&(P=e,r=Kt(r)),e=r,p[i]={nextPos:t,result:e},e)}function Oe(){var e,r,i,a,l,f=t*49+26,h=p[f];if(h)return t=h.nextPos,h.result;if(e=t,o.charCodeAt(t)===43?(r=Me,t++):(r=s,d===0&&m(Ne)),r===s&&(r=ie),r!==s){if(i=[],a=M(),a!==s)for(;a!==s;)i.push(a),a=M();else i=n;i!==s?(a=t,d++,o.charCodeAt(t)===46?(l=H,t++):(l=s,d===0&&m(O)),d--,l===s?a=D:(t=a,a=n),a!==s?(P=e,r=Ue(i),e=r):(t=e,e=n)):(t=e,e=n)}else t=e,e=n;if(e===s)if(e=t,o.charCodeAt(t)===45?(r=ce,t++):(r=s,d===0&&m(ue)),r!==s){if(i=[],a=M(),a!==s)for(;a!==s;)i.push(a),a=M();else i=n;i!==s?(a=t,d++,o.charCodeAt(t)===46?(l=H,t++):(l=s,d===0&&m(O)),d--,l===s?a=D:(t=a,a=n),a!==s?(P=e,r=He(i),e=r):(t=e,e=n)):(t=e,e=n)}else t=e,e=n;return p[f]={nextPos:t,result:e},e}function er(){var e,r,i=t*49+27,a=p[i];return a?(t=a.nextPos,a.result):(e=t,o.substr(t,4)===Je?(r=Je,t+=4):(r=s,d===0&&m(Zt)),r!==s&&(P=e,r=Gt()),e=r,e===s&&(e=t,o.substr(t,5)===Ke?(r=Ke,t+=5):(r=s,d===0&&m(Xt)),r!==s&&(P=e,r=Wt()),e=r),p[i]={nextPos:t,result:e},e)}function tr(){var e,r,i,a,l,f=t*49+28,h=p[f];if(h)return t=h.nextPos,h.result;if(e=t,o.charCodeAt(t)===91?(r=q,t++):(r=s,d===0&&m(Z)),r!==s){for(i=[],a=G();a!==s;)i.push(a),a=G();i!==s?(o.charCodeAt(t)===93?(a=U,t++):(a=s,d===0&&m(C)),a!==s?(P=e,r=Yt(),e=r):(t=e,e=n)):(t=e,e=n)}else t=e,e=n;if(e===s&&(e=t,o.charCodeAt(t)===91?(r=q,t++):(r=s,d===0&&m(Z)),r!==s?(i=At(),i===s&&(i=ie),i!==s?(o.charCodeAt(t)===93?(a=U,t++):(a=s,d===0&&m(C)),a!==s?(P=e,r=Qt(i),e=r):(t=e,e=n)):(t=e,e=n)):(t=e,e=n),e===s)){if(e=t,o.charCodeAt(t)===91?(r=q,t++):(r=s,d===0&&m(Z)),r!==s){if(i=[],a=xe(),a!==s)for(;a!==s;)i.push(a),a=xe();else i=n;i!==s?(o.charCodeAt(t)===93?(a=U,t++):(a=s,d===0&&m(C)),a!==s?(P=e,r=es(i),e=r):(t=e,e=n)):(t=e,e=n)}else t=e,e=n;if(e===s)if(e=t,o.charCodeAt(t)===91?(r=q,t++):(r=s,d===0&&m(Z)),r!==s){if(i=[],a=xe(),a!==s)for(;a!==s;)i.push(a),a=xe();else i=n;i!==s?(a=At(),a!==s?(o.charCodeAt(t)===93?(l=U,t++):(l=s,d===0&&m(C)),l!==s?(P=e,r=ts(i,a),e=r):(t=e,e=n)):(t=e,e=n)):(t=e,e=n)}else t=e,e=n}return p[f]={nextPos:t,result:e},e}function At(){var e,r,i,a,l,f=t*49+29,h=p[f];if(h)return t=h.nextPos,h.result;for(e=t,r=[],i=G();i!==s;)r.push(i),i=G();if(r!==s)if(i=le(),i!==s){for(a=[],l=G();l!==s;)a.push(l),l=G();a!==s?(P=e,r=Ze(i),e=r):(t=e,e=n)}else t=e,e=n;else t=e,e=n;return p[f]={nextPos:t,result:e},e}function xe(){var e,r,i,a,l,f,h,v=t*49+30,b=p[v];if(b)return t=b.nextPos,b.result;for(e=t,r=[],i=G();i!==s;)r.push(i),i=G();if(r!==s)if(i=le(),i!==s){for(a=[],l=G();l!==s;)a.push(l),l=G();if(a!==s)if(o.charCodeAt(t)===44?(l=Ge,t++):(l=s,d===0&&m(Xe)),l!==s){for(f=[],h=G();h!==s;)f.push(h),h=G();f!==s?(P=e,r=Ze(i),e=r):(t=e,e=n)}else t=e,e=n;else t=e,e=n}else t=e,e=n;else t=e,e=n;return p[v]={nextPos:t,result:e},e}function G(){var e,r=t*49+31,i=p[r];return i?(t=i.nextPos,i.result):(e=y(),e===s&&(e=X(),e===s&&(e=Pe())),p[r]={nextPos:t,result:e},e)}function sr(){var e,r,i,a,l,f,h=t*49+32,v=p[h];if(v)return t=v.nextPos,v.result;if(e=t,o.charCodeAt(t)===123?(r=ss,t++):(r=s,d===0&&m(rs)),r!==s){for(i=[],a=y();a!==s;)i.push(a),a=y();if(i!==s){for(a=[],l=Et();l!==s;)a.push(l),l=Et();if(a!==s){for(l=[],f=y();f!==s;)l.push(f),f=y();l!==s?(o.charCodeAt(t)===125?(f=is,t++):(f=s,d===0&&m(as)),f!==s?(P=e,r=ns(a),e=r):(t=e,e=n)):(t=e,e=n)}else t=e,e=n}else t=e,e=n}else t=e,e=n;return p[h]={nextPos:t,result:e},e}function Et(){var e,r,i,a,l,f,h,v,b,N,S,B=t*49+33,L=p[B];if(L)return t=L.nextPos,L.result;for(e=t,r=[],i=y();i!==s;)r.push(i),i=y();if(r!==s)if(i=pe(),i!==s){for(a=[],l=y();l!==s;)a.push(l),l=y();if(a!==s)if(o.charCodeAt(t)===61?(l=Q,t++):(l=s,d===0&&m(ee)),l!==s){for(f=[],h=y();h!==s;)f.push(h),h=y();if(f!==s)if(h=le(),h!==s){for(v=[],b=y();b!==s;)v.push(b),b=y();if(v!==s)if(o.charCodeAt(t)===44?(b=Ge,t++):(b=s,d===0&&m(Xe)),b!==s){for(N=[],S=y();S!==s;)N.push(S),S=y();N!==s?(P=e,r=We(i,h),e=r):(t=e,e=n)}else t=e,e=n;else t=e,e=n}else t=e,e=n;else t=e,e=n}else t=e,e=n;else t=e,e=n}else t=e,e=n;else t=e,e=n;if(e===s){for(e=t,r=[],i=y();i!==s;)r.push(i),i=y();if(r!==s)if(i=pe(),i!==s){for(a=[],l=y();l!==s;)a.push(l),l=y();if(a!==s)if(o.charCodeAt(t)===61?(l=Q,t++):(l=s,d===0&&m(ee)),l!==s){for(f=[],h=y();h!==s;)f.push(h),h=y();f!==s?(h=le(),h!==s?(P=e,r=We(i,h),e=r):(t=e,e=n)):(t=e,e=n)}else t=e,e=n;else t=e,e=n}else t=e,e=n;else t=e,e=n}return p[B]={nextPos:t,result:e},e}function _t(){var e,r,i,a=t*49+34,l=p[a];return l?(t=l.nextPos,l.result):(e=t,o.charCodeAt(t)===46?(r=H,t++):(r=s,d===0&&m(O)),r!==s?(i=ge(),i!==s?(P=e,r=ls(i),e=r):(t=e,e=n)):(t=e,e=n),p[a]={nextPos:t,result:e},e)}function kt(){var e,r,i,a,l,f,h,v,b,N,S,B,L=t*49+35,J=p[L];return J?(t=J.nextPos,J.result):(e=t,r=t,i=M(),i!==s?(a=M(),a!==s?(l=M(),l!==s?(f=M(),f!==s?(o.charCodeAt(t)===45?(h=ce,t++):(h=s,d===0&&m(ue)),h!==s?(v=M(),v!==s?(b=M(),b!==s?(o.charCodeAt(t)===45?(N=ce,t++):(N=s,d===0&&m(ue)),N!==s?(S=M(),S!==s?(B=M(),B!==s?(i=[i,a,l,f,h,v,b,N,S,B],r=i):(t=r,r=n)):(t=r,r=n)):(t=r,r=n)):(t=r,r=n)):(t=r,r=n)):(t=r,r=n)):(t=r,r=n)):(t=r,r=n)):(t=r,r=n)):(t=r,r=n),r!==s&&(P=e,r=os(r)),e=r,p[L]={nextPos:t,result:e},e)}function rr(){var e,r,i,a,l,f,h,v,b,N,S,B=t*49+36,L=p[B];return L?(t=L.nextPos,L.result):(e=t,r=t,i=M(),i!==s?(a=M(),a!==s?(o.charCodeAt(t)===58?(l=fe,t++):(l=s,d===0&&m(he)),l!==s?(f=M(),f!==s?(h=M(),h!==s?(o.charCodeAt(t)===58?(v=fe,t++):(v=s,d===0&&m(he)),v!==s?(b=M(),b!==s?(N=M(),N!==s?(S=_t(),S===s&&(S=ie),S!==s?(i=[i,a,l,f,h,v,b,N,S],r=i):(t=r,r=n)):(t=r,r=n)):(t=r,r=n)):(t=r,r=n)):(t=r,r=n)):(t=r,r=n)):(t=r,r=n)):(t=r,r=n)):(t=r,r=n),r!==s&&(P=e,r=Ye(r)),e=r,p[B]={nextPos:t,result:e},e)}function ir(){var e,r,i,a,l,f,h,v,b,N,S,B,L,J,oe,se,K,Bt=t*49+37,Fe=p[Bt];return Fe?(t=Fe.nextPos,Fe.result):(e=t,r=t,i=M(),i!==s?(a=M(),a!==s?(o.charCodeAt(t)===58?(l=fe,t++):(l=s,d===0&&m(he)),l!==s?(f=M(),f!==s?(h=M(),h!==s?(o.charCodeAt(t)===58?(v=fe,t++):(v=s,d===0&&m(he)),v!==s?(b=M(),b!==s?(N=M(),N!==s?(S=_t(),S===s&&(S=ie),S!==s?(o.charCodeAt(t)===45?(B=ce,t++):(B=s,d===0&&m(ue)),B===s&&(o.charCodeAt(t)===43?(B=Me,t++):(B=s,d===0&&m(Ne))),B!==s?(L=M(),L!==s?(J=M(),J!==s?(o.charCodeAt(t)===58?(oe=fe,t++):(oe=s,d===0&&m(he)),oe!==s?(se=M(),se!==s?(K=M(),K!==s?(i=[i,a,l,f,h,v,b,N,S,B,L,J,oe,se,K],r=i):(t=r,r=n)):(t=r,r=n)):(t=r,r=n)):(t=r,r=n)):(t=r,r=n)):(t=r,r=n)):(t=r,r=n)):(t=r,r=n)):(t=r,r=n)):(t=r,r=n)):(t=r,r=n)):(t=r,r=n)):(t=r,r=n)):(t=r,r=n)):(t=r,r=n),r!==s&&(P=e,r=Ye(r)),e=r,p[Bt]={nextPos:t,result:e},e)}function ar(){var e,r,i,a,l,f=t*49+38,h=p[f];return h?(t=h.nextPos,h.result):(e=t,r=kt(),r!==s?(o.charCodeAt(t)===84?(i=Qe,t++):(i=s,d===0&&m(et)),i!==s?(a=rr(),a!==s?(o.charCodeAt(t)===90?(l=cs,t++):(l=s,d===0&&m(us)),l!==s?(P=e,r=fs(r,a),e=r):(t=e,e=n)):(t=e,e=n)):(t=e,e=n)):(t=e,e=n),e===s&&(e=t,r=kt(),r!==s?(o.charCodeAt(t)===84?(i=Qe,t++):(i=s,d===0&&m(et)),i!==s?(a=ir(),a!==s?(P=e,r=hs(r,a),e=r):(t=e,e=n)):(t=e,e=n)):(t=e,e=n)),p[f]={nextPos:t,result:e},e)}function y(){var e,r=t*49+39,i=p[r];return i?(t=i.nextPos,i.result):(ds.test(o.charAt(t))?(e=o.charAt(t),t++):(e=s,d===0&&m(ps)),p[r]={nextPos:t,result:e},e)}function X(){var e,r,i,a=t*49+40,l=p[a];return l?(t=l.nextPos,l.result):(o.charCodeAt(t)===10?(e=tt,t++):(e=s,d===0&&m(st)),e===s&&(e=t,o.charCodeAt(t)===13?(r=gs,t++):(r=s,d===0&&m(ms)),r!==s?(o.charCodeAt(t)===10?(i=tt,t++):(i=s,d===0&&m(st)),i!==s?(r=[r,i],e=r):(t=e,e=n)):(t=e,e=n)),p[a]={nextPos:t,result:e},e)}function St(){var e,r=t*49+41,i=p[r];return i?(t=i.nextPos,i.result):(e=X(),e===s&&(e=y()),p[r]={nextPos:t,result:e},e)}function Ce(){var e,r,i=t*49+42,a=p[i];return a?(t=a.nextPos,a.result):(e=t,d++,o.length>t?(r=o.charAt(t),t++):(r=s,d===0&&m(z)),d--,r===s?e=D:(t=e,e=n),p[i]={nextPos:t,result:e},e)}function W(){var e,r=t*49+43,i=p[r];return i?(t=i.nextPos,i.result):(vs.test(o.charAt(t))?(e=o.charAt(t),t++):(e=s,d===0&&m(ys)),p[r]={nextPos:t,result:e},e)}function M(){var e,r,i=t*49+44,a=p[i];return a?(t=a.nextPos,a.result):($s.test(o.charAt(t))?(e=o.charAt(t),t++):(e=s,d===0&&m(Ps)),e===s&&(e=t,o.charCodeAt(t)===95?(r=xs,t++):(r=s,d===0&&m(Cs)),r!==s&&(P=e,r=ws()),e=r),p[i]={nextPos:t,result:e},e)}function Mt(){var e,r=t*49+45,i=p[r];return i?(t=i.nextPos,i.result):(bs.test(o.charAt(t))?(e=o.charAt(t),t++):(e=s,d===0&&m(As)),p[r]={nextPos:t,result:e},e)}function ge(){var e,r,i,a=t*49+46,l=p[a];if(l)return t=l.nextPos,l.result;if(e=t,r=[],i=M(),i!==s)for(;i!==s;)r.push(i),i=M();else r=n;return r!==s&&(P=e,r=Es(r)),e=r,p[a]={nextPos:t,result:e},e}function Nt(){var e,r,i=t*49+47,a=p[i];return a?(t=a.nextPos,a.result):(e=t,o.substr(t,2)===rt?(r=rt,t+=2):(r=s,d===0&&m(_s)),r!==s&&(P=e,r=ks()),e=r,e===s&&(e=t,o.substr(t,2)===it?(r=it,t+=2):(r=s,d===0&&m(Ss)),r!==s&&(P=e,r=Ms()),e=r,e===s&&(e=t,o.substr(t,2)===at?(r=at,t+=2):(r=s,d===0&&m(Ns)),r!==s&&(P=e,r=Ts()),e=r,e===s&&(e=t,o.substr(t,2)===nt?(r=nt,t+=2):(r=s,d===0&&m(Bs)),r!==s&&(P=e,r=Ls()),e=r,e===s&&(e=t,o.substr(t,2)===lt?(r=lt,t+=2):(r=s,d===0&&m(Vs)),r!==s&&(P=e,r=Os()),e=r,e===s&&(e=t,o.substr(t,2)===ot?(r=ot,t+=2):(r=s,d===0&&m(Ds)),r!==s&&(P=e,r=Fs()),e=r,e===s&&(e=t,o.substr(t,2)===ct?(r=ct,t+=2):(r=s,d===0&&m(Is)),r!==s&&(P=e,r=js()),e=r,e===s&&(e=nr()))))))),p[i]={nextPos:t,result:e},e)}function nr(){var e,r,i,a,l,f,h,v,b,N,S,B=t*49+48,L=p[B];return L?(t=L.nextPos,L.result):(e=t,o.substr(t,2)===ut?(r=ut,t+=2):(r=s,d===0&&m(Rs)),r!==s?(i=t,a=W(),a!==s?(l=W(),l!==s?(f=W(),f!==s?(h=W(),h!==s?(v=W(),v!==s?(b=W(),b!==s?(N=W(),N!==s?(S=W(),S!==s?(a=[a,l,f,h,v,b,N,S],i=a):(t=i,i=n)):(t=i,i=n)):(t=i,i=n)):(t=i,i=n)):(t=i,i=n)):(t=i,i=n)):(t=i,i=n)):(t=i,i=n),i!==s?(P=e,r=ft(i),e=r):(t=e,e=n)):(t=e,e=n),e===s&&(e=t,o.substr(t,2)===ht?(r=ht,t+=2):(r=s,d===0&&m(qs)),r!==s?(i=t,a=W(),a!==s?(l=W(),l!==s?(f=W(),f!==s?(h=W(),h!==s?(a=[a,l,f,h],i=a):(t=i,i=n)):(t=i,i=n)):(t=i,i=n)):(t=i,i=n),i!==s?(P=e,r=ft(i),e=r):(t=e,e=n)):(t=e,e=n)),p[B]={nextPos:t,result:e},e)}var Tt=[];function lr(e,r,i){var a=new Error(e);throw a.line=r,a.column=i,a}function De(e){Tt.push(e)}function R(e,r,i,a,l){var f={type:e,value:r,line:i(),column:a()};return l&&(f.key=l),f}function or(e,r,i){var a=parseInt("0x"+e);if(!isFinite(a)||Math.floor(a)!=a||a<0||a>1114111||a>55295&&a<57344)lr("Invalid Unicode escape code: "+e,r,i);else return cr(a)}function cr(){var e=16384,r=[],i,a,l=-1,f=arguments.length;if(!f)return"";for(var h="";++l<f;){var v=Number(arguments[l]);v<=65535?r.push(v):(v-=65536,i=(v>>10)+55296,a=v%1024+56320,r.push(i,a)),(l+1==f||r.length>e)&&(h+=String.fromCharCode.apply(null,r),r.length=0)}return h}if($e=x(),$e!==s&&t===o.length)return $e;throw $e!==s&&t<o.length&&m({type:"end",description:"end of input"}),zs(null,Be,ye)}return{SyntaxError:c,parse:u}}();function gr(E){var c=[],u=[],o="",g=Object.create(null),s=g;return $(E);function $(C){for(var A,k=0;k<C.length;k++)switch(A=C[k],A.type){case"Assign":w(A);break;case"ObjectPath":D(A);break;case"ArrayPath":z(A);break}return g}function x(C,A,k){var _=new Error(C);throw _.line=A,_.column=k,_}function w(C){var A=C.key,k=C.value,_=C.line,Y=C.column,F;o?F=o+"."+A:F=A,typeof s[A]<"u"&&x("Cannot redefine existing key '"+F+"'.",_,Y),s[A]=V(k),n(F)||(c.push(F),u.push(F))}function n(C){return c.indexOf(C)!==-1}function V(C){return C.type==="Array"?Z(C.value):C.type==="InlineTable"?te(C.value):C.value}function te(C){for(var A=Object.create(null),k=0;k<C.length;k++){var _=C[k];_.value.type==="InlineTable"?A[_.key]=te(_.value.value):_.type==="InlineTableValue"&&(A[_.key]=V(_.value))}return A}function D(C){var A=C.value,k=A.map(U).join("."),_=C.line,Y=C.column;n(k)&&x("Cannot redefine existing key '"+A+"'.",_,Y),c.push(k),s=q(g,A,Object.create(null),_,Y),o=A}function z(C){var A=C.value,k=A.map(U).join("."),_=C.line,Y=C.column;if(n(k)||c.push(k),c=c.filter(function(H){return H.indexOf(k)!==0}),c.push(k),s=q(g,A,[],_,Y),o=k,s instanceof Array){var F=Object.create(null);s.push(F),s=F}else x("Cannot redefine existing key '"+A+"'.",_,Y)}function q(C,A,k,_,Y){var F=[],H="";A.join(".");for(var O=C,Q=0;Q<A.length;Q++){var ee=A[Q];F.push(ee),H=F.join("."),typeof O[ee]>"u"?Q===A.length-1?O[ee]=k:O[ee]=Object.create(null):Q!==A.length-1&&u.indexOf(H)>-1&&x("Cannot redefine existing key '"+H+"'.",_,Y),O=O[ee],O instanceof Array&&O.length&&Q<A.length-1&&(O=O[O.length-1])}return O}function Z(C){for(var A=null,k=0;k<C.length;k++){var _=C[k];A===null?A=_.type:_.type!==A&&x("Cannot add value of type "+_.type+" to array of type "+A+".",_.line,_.column)}return C.map(V)}function U(C){return C.indexOf(".")>-1?'"'+C+'"':C}}var mr={compile:gr},vr=pr,yr=mr,$r={parse:function(E){var c=vr.parse(E.toString());return yr.compile(c)}};const Pr=dr($r);class Lt{constructor(c){T(this,"raw");T(this,"tree");this.raw=c;try{this.tree=Pr.parse(c)||{}}catch(u){console.error("TOML parse error",u),this.tree={}}}getRaw(){return this.raw}listVps(){const c=this.tree.aff??{},u=this.tree.url??{},o=this.tree.vps??{},g=[];return Object.entries(o).forEach(([s,$])=>{Object.entries($).forEach(([x,w])=>{var z,q;const n=w.pid||x,V=((z=u[s])==null?void 0:z.sale_format)??"",te=((q=u[s])==null?void 0:q.valid_format)??"",D=this.resolveAffCode(c[s]);g.push({vendor:s,pid:n,humanComment:w.human_comment||"",saleUrl:this.fillTemplate(V,D,n),validUrl:this.fillTemplate(te,D,n)})})}),g}getIntervalSeconds(c){var o,g;const u=(g=(o=this.tree.url)==null?void 0:o[c])==null?void 0:g.valid_interval_time;return u?Number(u):86400}getDelayRange(c){var x,w;const u=((w=(x=this.tree.url)==null?void 0:x[c])==null?void 0:w.valid_vps_time)??"5-10";if(!u.includes("-")){const n=Math.max(1,Number(u));return{min:n,max:n}}const[o,g]=u.split("-"),s=Math.max(1,Number(o)),$=Math.max(s,Number(g));return{min:s,max:$}}resolveAffCode(c){return c?c.code??Object.values(c).join(""):""}fillTemplate(c,u,o){return c?c.replace("{aff}",encodeURIComponent(u)).replace("{pid}",encodeURIComponent(o)):""}}class Vt{constructor(c,u){T(this,"element");this.element=document.createElement("div"),this.element.className="asv-modal hidden";const o=document.createElement("div");o.className="asv-modal__body";const g=document.createElement("header");g.className="asv-modal__header",g.innerHTML=`<h3>${c}</h3>`;const s=document.createElement("button");s.className="asv-modal__close",s.type="button",s.textContent="√ó",s.addEventListener("click",()=>this.hide()),g.appendChild(s),o.appendChild(g),o.appendChild(u),this.element.appendChild(o)}mount(c){c.appendChild(this.element)}show(){this.element.classList.remove("hidden")}hide(){this.element.classList.add("hidden")}getNode(){return this.element}}class xr{constructor(c,u){T(this,"node");T(this,"timezone");this.node=c,this.timezone=u}setTimezone(c){this.timezone=c}push(c,u="info"){const o=this.formatTime(),g=document.createElement("div");g.className=`asv-log-row asv-log-${u}`,g.textContent=`[${o}] ${c}`,this.node.prepend(g)}clear(){this.node.innerHTML=""}formatTime(){try{return new Date().toLocaleString("zh-CN",{timeZone:this.timezone,hour12:!1})}catch(c){return console.warn("timezone fallback",c),new Date().toLocaleString()}}}const Cr="Á≠âÂæÖÊäìÂèñ VPS ËØ¶ÊÉÖÔºå‰øùÂ≠òÈÖçÁΩÆÂπ∂È™åËØÅÂêéËá™Âä®Â°´ÂÖÖ„ÄÇ";function wr(E,c){const u=(E||"").trim();return u.length?u:c.length?c.join(`
`):Cr}function Ie(E){switch(E){case"manual":return"ÂΩìÂâç‰∏∫ÁÆ°ÁêÜÂëòÊâãÂä®Êï¥ÁêÜÂÜÖÂÆπ";case"ai":return"Â∑≤Áî± AI Êï¥ÁêÜÂ±ïÁ§∫‰ø°ÊÅØ";case"raw":default:return"Âü∫‰∫éÊäìÂèñÁªìÊûúËá™Âä®Â°´ÂÖÖ"}}const br=`[aff]
[aff.rn]
4886

[url]
[url.rn]
sale_format = 'https://my.racknerd.com/aff.php?aff={aff}&pid={pid}'
valid_format = 'https://my.racknerd.com/cart.php?a=add&pid={pid}'
valid_interval_time = '172800'
valid_vps_time = '5-10'

[vps]
[vps.rn.923]
pid = '923'
human_comment = 'ÈùûÂ∏∏Âü∫Á°ÄÁöÑ‰∏ÄÊ¨æVPSÔºå‰ΩÜÊòØÂÆπÈáèÁõ∏ÂØπÊù•ËØ¥ËøòÊòØÊØîËæÉÂ§ßÁöÑ„ÄÇ'

[vps.rn.924]
pid = '924'
human_comment = ''

[vps.rn.925]
pid = '925'
human_comment = ''

[vps.rn.926]
pid = '926'
human_comment = ''

[vps.rn.927]
pid = '927'
human_comment = ''`,Ar=`[model_providers]
[model_providers.omg]
base_url = 'https://api.ohmygpt.com/v1'
model = 'gpt-4.1-mini'
prompt_valid = 'Âü∫‰∫éËæìÂÖ•Âà§Êñ≠VPSÊòØÂê¶Â∑≤ÁªèÂçñÂÆåÊàñ‰∏ãÊû∂ÔºõÂ¶ÇÊûúÂ∑≤ÁªèÂçñÂÆåÊàñ‰∏ãÊû∂ÔºåËØ∑ËøîÂõûFALSEÔºõÂê¶ÂàôÔºåËØ∑ËøîÂõûTRUE'
prompt_vps_info = 'Âü∫‰∫éËæìÂÖ•ÁªôÂá∫‰∏ÄÊñ≠Êé®ÈîÄVPSÁöÑÂπøÂëäÔºå20-100‰∏™ÁÆÄ‰Ωì‰∏≠Êñá„ÄÇÊé®ÂπøË¶ÅÊ±ÇË¥¥ÂêàVPSÁöÑÂÆûÈôÖÔºå‰∏çËÉΩÊó†ËÑëÊé®ÔºåË¶ÅÂÉè‰∏Ä‰∏™‰ºòÁßÄÁöÑVPSÊé®ÂπøÂïÜÈÇ£Ê†∑Êé®Âπø‰∫ßÂìÅ„ÄÇ'
prompt_meta_layout = 'ËØ∑Â∞ÜËæìÂÖ•JSONÊï¥ÁêÜÊàêÂõ∫ÂÆöÁöÑ8Ë°å‰∏≠ÊñáÔºå‰æùÊ¨°‰∏∫ÔºöÂéÇÂïÜ„ÄÅCPU„ÄÅÂÜÖÂ≠ò„ÄÅÂ≠òÂÇ®„ÄÅÂ∏¶ÂÆΩ„ÄÅÁΩëÁªú„ÄÅ‰ª∑Ê†º„ÄÅÂú∞ÁêÜ‰ΩçÁΩÆ„ÄÇÊØè‰∏ÄË°åÂøÖÈ°ª‰ΩøÁî®‚ÄúÂ≠óÊÆµÔºöÂÜÖÂÆπ‚ÄùÊ†ºÂºèÔºåÂ≠óÊÆµÂêçÈúÄ‰∏é‰∏äËø∞ÂÆåÂÖ®‰∏ÄËá¥ÔºåÂ¶Ç‰ø°ÊÅØÁº∫Â§±ÂàôÂ°´‚Äú-‚ÄùÔºå‰∏çË¶ÅËæìÂá∫ÂÖ∂‰ªñÊñáÂ≠ó„ÄÇ'`,Er=`/* ÈÄÇÈÖç https://blognas.hwb0307.com/ad ÁöÑÈÄöÈÄèÂ∏ÉÂ±Ä */
.asv-root {
  padding: 0;
  background: transparent;
}

.asv-card {
  background: linear-gradient(135deg, rgba(255, 255, 255, 0.58), rgba(226, 239, 255, 0.32));
  border: 1px solid rgba(255, 255, 255, 0.25);
  border-radius: 24px;
  box-shadow: 0 35px 80px rgba(15, 23, 42, 0.25);
  backdrop-filter: blur(12px);
}

.asv-card--offline {
  border-color: rgba(239, 79, 79, 0.5);
  box-shadow: 0 35px 80px rgba(239, 79, 79, 0.4);
}

.asv-sale-btn {
  background: linear-gradient(120deg, #ff9f5a, #f05438);
  color: #fff !important;
  border: none;
  box-shadow: 0 14px 30px rgba(240, 84, 56, 0.3);
}`;class _r{constructor(c,u){T(this,"root");T(this,"rest");T(this,"logPanel");T(this,"logPanelHost");T(this,"logPanelClearButton");T(this,"bootstrap");T(this,"vpsContainer");T(this,"timezoneSelect");T(this,"configBundle");T(this,"modelBundle");T(this,"cssBundle");T(this,"keyModal");T(this,"keyInput");T(this,"hasKey");T(this,"currentConfig");T(this,"currentVps",[]);T(this,"availabilityTimer");T(this,"inFlightValidation",!1);T(this,"extraCssNode");this.root=c,this.bootstrap=u,this.rest=new hr(u.restUrl,u.nonce),this.hasKey=u.hasKey}init(){this.applyExtraCss(this.bootstrap.extraCss||""),this.renderLayout(),this.mountLogPanel(),this.attachTimezone(),this.attachButtons(),this.loadVpsCards(!0),this.bootstrap.isAdmin&&(this.prepareModals(),this.loadConfigForEditing(),this.loadModelForEditing(),this.loadExtraCss())}mountLogPanel(){var c;this.logPanel=new xr(this.logPanelHost,this.bootstrap.timezone),(c=this.logPanelClearButton)==null||c.addEventListener("click",()=>{this.logPanel.clear()})}renderLayout(){if(this.root.innerHTML="",this.bootstrap.isAdmin){const $=document.createElement("div");$.className="asv-toolbar";const x=document.createElement("div");x.className="asv-toolbar__row";const w=document.createElement("div");w.className="asv-actions";const n=document.createElement("div");n.className="asv-actions asv-actions--secondary";const V=this.createButton("ÁºñËæëVPSÈÖçÁΩÆ");V.dataset.action="edit-config";const te=this.createButton("ÁºñËæëÊ®°ÂûãÈÖçÁΩÆ");te.dataset.action="edit-model";const D=this.createButton(this.hasKey?"Êõ¥Êñ∞KEY":"Ê∑ªÂä†KEY");D.dataset.action="add-key";const z=this.createButton("È¢ùÂ§ñCSS");z.dataset.action="edit-css";const q=this.createButton("Ê£ÄÊü•ÂèØÁî®ÊÄß");q.dataset.action="diagnostics";const Z=this.createButton("Êü•ÁúãVPSÁä∂ÊÄÅ");Z.dataset.action="check-vps",w.append(V,te,D,z),n.append(q,Z);const U=document.createElement("div");U.className="asv-timezone";const C=document.createElement("label");C.textContent="Êó∂Âå∫";const A=document.createElement("select");this.bootstrap.options.forEach(k=>{const _=document.createElement("option");_.value=k,_.textContent=k,k===this.bootstrap.timezone&&(_.selected=!0),A.appendChild(_)}),this.timezoneSelect=A,C.appendChild(A),U.appendChild(C),x.append(w,U),$.append(x,n),this.root.appendChild($)}const c=document.createElement("div");c.className="asv-log-panel";const u=document.createElement("div");u.className="asv-log-panel__header";const o=document.createElement("span");o.textContent="Á≥ªÁªüÊó•Âøó";const g=document.createElement("button");g.type="button",g.className="asv-log-panel__clear",g.textContent="Ê∏ÖÁ©∫Êó•Âøó",u.append(o,g);const s=document.createElement("div");s.className="asv-log-panel__body",c.append(u,s),this.logPanelHost=s,this.logPanelClearButton=g,this.root.appendChild(c),this.vpsContainer=document.createElement("div"),this.vpsContainer.className="asv-vps-list",this.root.appendChild(this.vpsContainer)}createButton(c){const u=document.createElement("button");return u.type="button",u.textContent=c,u.className="asv-btn",u}attachTimezone(){var c;(c=this.timezoneSelect)==null||c.addEventListener("change",async()=>{const u=this.timezoneSelect.value;try{await this.rest.saveTimezone(u),this.logPanel.setTimezone(u),this.logPanel.push(`Â∑≤ÂàáÊç¢Âà∞ ${u}`)}catch(o){this.logPanel.push(`ËÆæÁΩÆÊó∂Âå∫Â§±Ë¥•Ôºö${o.message}`,"error")}})}attachButtons(){this.root.addEventListener("click",c=>{const u=c.target;if(u.matches("[data-action]")){if(!this.bootstrap.isAdmin){this.logPanel.push("ÈúÄË¶ÅÁÆ°ÁêÜÂëòÊùÉÈôêÊâßË°åÊ≠§Êìç‰Ωú","error");return}switch(u.dataset.action){case"edit-config":this.configBundle.modal.show();break;case"edit-model":this.modelBundle.modal.show();break;case"edit-css":this.cssBundle.modal.show();break;case"add-key":this.keyModal.show();break;case"check-vps":this.handleManualStatusCheck();break;case"diagnostics":this.runDiagnostics();break}}})}async handleManualStatusCheck(){this.bootstrap.isAdmin&&(await this.loadVpsCards(!1),this.triggerAvailabilitySweep("ÊâãÂä®Êü•ÁúãVPSÁä∂ÊÄÅ"))}prepareModals(){this.configBundle=this.createEditorModal("ÁºñËæë config.toml",br,async()=>{try{await this.rest.saveConfig(this.configBundle.textarea.value),this.logPanel.push("ÈÖçÁΩÆÂ∑≤‰øùÂ≠ò","success"),this.currentConfig=new Lt(this.configBundle.textarea.value),this.scheduleValidation(),this.configBundle.modal.hide()}catch(s){this.logPanel.push(`‰øùÂ≠òÂ§±Ë¥•Ôºö${s.message}`,"error")}}),this.modelBundle=this.createEditorModal("ÁºñËæë model.toml",Ar,async()=>{try{await this.rest.saveModel(this.modelBundle.textarea.value),this.logPanel.push("Ê®°ÂûãÈÖçÁΩÆÂ∑≤‰øùÂ≠ò","success"),this.modelBundle.modal.hide()}catch(s){this.logPanel.push(`‰øùÂ≠òÊ®°ÂûãÂ§±Ë¥•Ôºö${s.message}`,"error")}}),this.cssBundle=this.createEditorModal("È¢ùÂ§ñ CSSÔºàÂèØÈÄâÔºâ",Er,async()=>{try{await this.rest.saveExtraCss(this.cssBundle.textarea.value),this.applyExtraCss(this.cssBundle.textarea.value),this.logPanel.push("È¢ùÂ§ñ CSS Â∑≤‰øùÂ≠ò","success"),this.cssBundle.modal.hide()}catch(s){this.logPanel.push(`‰øùÂ≠ò CSS Â§±Ë¥•Ôºö${s.message}`,"error")}});const c=document.createElement("div");c.className="asv-modal__content";const u=document.createElement("input");u.type="password",u.placeholder="sk-xxx",u.className="asv-input",this.keyInput=u;const o=document.createElement("button");o.type="button",o.className="asv-eye",o.textContent="üëÅ",o.addEventListener("mouseenter",()=>{this.keyInput.type="text"}),o.addEventListener("mouseleave",()=>{this.keyInput.type="password"});const g=this.createButton("‰øùÂ≠òÈÖçÁΩÆ");g.addEventListener("click",async()=>{try{await this.rest.saveApiKey(this.keyInput.value),this.hasKey=!0,this.logPanel.push("API KEY Â∑≤Êõ¥Êñ∞","success"),this.keyModal.hide(),this.keyInput.value=""}catch(s){this.logPanel.push(`‰øùÂ≠ò KEY Â§±Ë¥•Ôºö${s.message}`,"error")}}),c.append(u,o,g),this.keyModal=new Vt("Ê∑ªÂä†/Êõ¥Êñ∞ KEY",c),this.keyModal.mount(this.root)}createEditorModal(c,u,o){const g=document.createElement("div");if(g.className="asv-modal__content",u){const w=document.createElement("details");w.className="asv-helper";const n=document.createElement("summary");n.textContent="Êü•ÁúãÈªòËÆ§Á§∫‰æã";const V=document.createElement("pre");V.textContent=u,w.append(n,V),g.appendChild(w)}const s=document.createElement("textarea");s.className="asv-textarea",s.rows=18;const $=this.createButton("‰øùÂ≠òÈÖçÁΩÆ");$.addEventListener("click",o),g.append(s,$);const x=new Vt(c,g);return x.mount(this.root),{modal:x,textarea:s,saveButton:$}}async loadConfigForEditing(){try{const{content:c}=await this.rest.fetchConfig();this.configBundle.textarea.value=c,this.currentConfig=new Lt(c),this.logPanel.push("Â∑≤ËΩΩÂÖ• config.toml"),this.scheduleValidation()}catch(c){this.logPanel.push(`ËΩΩÂÖ• config.toml Â§±Ë¥•Ôºö${c.message}`,"error")}}async loadModelForEditing(){try{const{content:c}=await this.rest.fetchModel();this.modelBundle.textarea.value=c,this.logPanel.push("Â∑≤ËΩΩÂÖ• model.toml")}catch(c){this.logPanel.push(`ËΩΩÂÖ• model.toml Â§±Ë¥•Ôºö${c.message}`,"error")}}async loadExtraCss(){try{const{extraCss:c}=await this.rest.fetchExtraCss();this.cssBundle.textarea.value=c,this.applyExtraCss(c),this.logPanel.push("Â∑≤ËΩΩÂÖ•È¢ùÂ§ñ CSS")}catch(c){this.logPanel.push(`ËΩΩÂÖ•È¢ùÂ§ñ CSS Â§±Ë¥•Ôºö${c.message}`,"error")}}async loadVpsCards(c=!0){this.vpsContainer.innerHTML='<div class="asv-loading">Ê≠£Âú®ËΩΩÂÖ•VPSÊï∞ÊçÆ...</div>';try{const{vps:u}=c?await this.rest.fetchCachedVps():await this.rest.fetchVps();this.currentVps=u,this.renderVpsList(u),this.bootstrap.isAdmin&&(c?this.logPanel.push("Â∑≤ËΩΩÂÖ•ÁºìÂ≠òÁöÑ VPS Áä∂ÊÄÅÔºåÂ¶ÇÈúÄÊõ¥Êñ∞ËØ∑ÁÇπÂáª‚ÄúÊü•ÁúãVPSÁä∂ÊÄÅ‚Äù","info"):this.logPanel.push("Â∑≤ÊäìÂèñÊúÄÊñ∞ VPS Êï∞ÊçÆ","success"),this.scheduleValidation())}catch(u){this.vpsContainer.innerHTML='<p class="asv-error">Êó†Ê≥ïËé∑ÂèñVPS‰ø°ÊÅØ</p>',this.logPanel.push(`Ëé∑ÂèñVPSÂ§±Ë¥•Ôºö${u.message}`,"error")}}renderVpsList(c){if(this.vpsContainer.innerHTML="",!c.length){this.vpsContainer.innerHTML="<p>ÊöÇÊó† VPS ËÆ∞ÂΩï</p>";return}c.forEach(u=>{const o=document.createElement("article");o.className="asv-card",o.dataset.key=`${u.vendor}-${u.pid}`,u.available===!1&&o.classList.add("asv-card--offline");const g=document.createElement("div");g.className="asv-card__title";const s=document.createElement("strong");s.textContent=`${u.vendor.toUpperCase()} #${u.pid}`,g.append(s,this.createStatusPill(u)),o.appendChild(g);const $=document.createElement("a");if($.href=u.sale_url,$.target="_blank",$.rel="noopener",$.className="asv-sale-btn",$.textContent="ÊâìÂºÄÊé®ÂπøÈìæÊé•",o.appendChild($),this.bootstrap.isAdmin)o.appendChild(this.createPromoEditor(u));else{const w=document.createElement("p");w.className="asv-card__promo",w.textContent=this.formatPromo(u),o.appendChild(w)}if(this.bootstrap.isAdmin?o.appendChild(this.createMetaEditor(u)):o.appendChild(this.createMetaViewer(u)),u.human_comment){const w=document.createElement("div");w.className="asv-card__note",w.textContent=u.human_comment,o.appendChild(w)}const x=document.createElement("footer");if(x.className="asv-card__footer",this.bootstrap.isAdmin){const w=document.createElement("button");w.className="asv-btn asv-btn--ghost",w.type="button",w.textContent="È™åËØÅ",w.addEventListener("click",()=>this.validateSingle(u.vendor,u.pid,"ÊâãÂä®È™åËØÅ")),x.appendChild(w)}o.appendChild(x),this.vpsContainer.appendChild(o)})}createPromoEditor(c){const u=document.createElement("div");u.className="asv-promo-editor";const o=document.createElement("textarea");o.className="asv-promo-editor__textarea",o.value=c.promo||"",o.placeholder="ËæìÂÖ•Ëá™ÂÆö‰πâÊé®ÂπøËØ≠Ôºå20-100 Â≠óÔºå‰øùÊåÅÁúüÂÆûÈÖçÁΩÆ„ÄÇ",u.appendChild(o);const g=document.createElement("div");g.className="asv-promo-actions";const s=this.createButton("‰øùÂ≠òÊé®ÂπøËØ≠");s.classList.add("asv-btn--sm");const $=this.createButton("AI ÈáçÂÜô");return $.classList.add("asv-btn--ghost","asv-btn--sm"),s.addEventListener("click",()=>this.persistPromoOverride(c.vendor,c.pid,o,s,$)),$.addEventListener("click",()=>this.regeneratePromo(c.vendor,c.pid,o,s,$)),g.append(s,$),u.appendChild(g),u}createMetaViewer(c){const u=document.createElement("div");u.className="asv-meta-section";const o=document.createElement("pre");return o.className="asv-meta-block",o.textContent=this.formatMetaDisplay(c),u.appendChild(o),u}createMetaEditor(c){const u=document.createElement("div");u.className="asv-meta-editor";const o=document.createElement("textarea");o.className="asv-meta-editor__textarea asv-meta-block",o.value=this.formatMetaDisplay(c),o.spellcheck=!1,u.appendChild(o);const g=document.createElement("div");g.className="asv-meta-hint",g.textContent=Ie(c.meta_source),u.appendChild(g);const s=document.createElement("div");s.className="asv-meta-actions";const $=this.createButton("‰øùÂ≠ò‰ø°ÊÅØ");$.classList.add("asv-btn--sm");const x=this.createButton("AI Êï¥ÁêÜ");return x.classList.add("asv-btn--ghost","asv-btn--sm"),$.addEventListener("click",()=>this.persistMetaOverride(c.vendor,c.pid,o,g,$,x)),x.addEventListener("click",()=>this.regenerateMeta(c.vendor,c.pid,o,g,$,x)),s.append($,x),u.appendChild(s),u}formatMetaDisplay(c){return wr(c.meta_display,c.meta||[])}togglePromoButtons(c,...u){u.forEach(o=>{o.disabled=c})}toggleMetaButtons(c,...u){u.forEach(o=>{o.disabled=c})}async persistPromoOverride(c,u,o,g,s){const $=o.value.trim();if(!$){this.logPanel.push("Êé®ÂπøËØ≠‰∏çËÉΩ‰∏∫Á©∫","error"),o.focus();return}this.togglePromoButtons(!0,g,s);try{const x=await this.rest.savePromo(c,u,$);o.value=x.promo||"",this.updatePromoRecord(c,u,x.promo,x.source),this.logPanel.push(`${c} ${u} Êé®ÂπøËØ≠Â∑≤‰øùÂ≠ò`,"success")}catch(x){this.logPanel.push(`‰øùÂ≠òÊé®ÂπøËØ≠Â§±Ë¥•Ôºö${x.message}`,"error")}finally{this.togglePromoButtons(!1,g,s)}}async persistMetaOverride(c,u,o,g,s,$){const x=o.value.trim();if(!x){this.logPanel.push("Â±ïÁ§∫‰ø°ÊÅØ‰∏çËÉΩ‰∏∫Á©∫","error"),o.focus();return}this.toggleMetaButtons(!0,s,$);try{const w=await this.rest.saveMeta(c,u,x),n=w.content||"";o.value=n,g.textContent=Ie(w.source),this.updateMetaRecord(c,u,n,w.source),this.logPanel.push(`${c} ${u} ÂÖÉ‰ø°ÊÅØÂ∑≤‰øùÂ≠ò`,"success")}catch(w){this.logPanel.push(`‰øùÂ≠òÂÖÉ‰ø°ÊÅØÂ§±Ë¥•Ôºö${w.message}`,"error")}finally{this.toggleMetaButtons(!1,s,$)}}async regenerateMeta(c,u,o,g,s,$){this.toggleMetaButtons(!0,s,$);try{const x=await this.rest.refreshMeta(c,u),w=x.content||"";o.value=w,g.textContent=Ie(x.source),this.updateMetaRecord(c,u,w,x.source),this.logPanel.push(`${c} ${u} ÂÖÉ‰ø°ÊÅØÂ∑≤Áî± AI Êï¥ÁêÜ`,"success")}catch(x){this.logPanel.push(`AI Êï¥ÁêÜÂ§±Ë¥•Ôºö${x.message}`,"error")}finally{this.toggleMetaButtons(!1,s,$)}}async regeneratePromo(c,u,o,g,s){this.togglePromoButtons(!0,g,s);try{const $=await this.rest.refreshPromo(c,u);o.value=$.promo||"",this.updatePromoRecord(c,u,$.promo,$.source),this.logPanel.push(`${c} ${u} Êé®ÂπøËØ≠Â∑≤ÈáçÊñ∞ÁîüÊàê`,"success")}catch($){this.logPanel.push(`ÈáçÊñ∞ÁîüÊàêÊé®ÂπøËØ≠Â§±Ë¥•Ôºö${$.message}`,"error")}finally{this.togglePromoButtons(!1,g,s)}}updatePromoRecord(c,u,o,g){const s=this.currentVps.find($=>$.vendor===c&&$.pid===u);s&&(s.promo=o,s.promo_source=g)}updateMetaRecord(c,u,o,g){const s=this.currentVps.find($=>$.vendor===c&&$.pid===u);s&&(s.meta_display=o,s.meta_source=g)}formatPromo(c){return c.promo||"Á≠âÂæÖÁîüÊàêÊé®ÂπøËØùÊúØ..."}createStatusPill(c){const u=document.createElement("span");return u.className="asv-status-pill",c.available===null?(u.classList.add("asv-status-pill--idle"),u.textContent="Á≠âÂæÖÈ™åËØÅ"):c.available?(u.classList.add("asv-status-pill--up"),u.textContent="Âú®Á∫ø"):(u.classList.add("asv-status-pill--down"),u.textContent="Â∑≤ÂîÆÁΩÑ"),u}scheduleValidation(){if(!this.bootstrap.isAdmin||!this.currentConfig)return;this.availabilityTimer&&window.clearInterval(this.availabilityTimer);const c=this.currentConfig.listVps();if(!c.length)return;const u=c.map(g=>{var s;return((s=this.currentConfig)==null?void 0:s.getIntervalSeconds(g.vendor))??86400}),o=Math.max(60,Math.min(...u));this.availabilityTimer=window.setInterval(()=>{this.triggerAvailabilitySweep("ÂÆöÊó∂Â∑°Ê£Ä")},o*1e3)}triggerAvailabilitySweep(c){!this.bootstrap.isAdmin||this.inFlightValidation||(this.inFlightValidation=!0,this.logPanel.push(`${c}ÔºöÂºÄÂßãÈ™åËØÅÊâÄÊúâ VPS`),this.validateAll().catch(u=>this.logPanel.push(`ÊâπÈáèÈ™åËØÅÂ§±Ë¥•Ôºö${u.message}`,"error")).finally(()=>{this.inFlightValidation=!1}))}async validateAll(){var c;for(const u of this.currentVps){await this.validateSingle(u.vendor,u.pid,"ÊâπÈáèÈòüÂàó");const o=((c=this.currentConfig)==null?void 0:c.getDelayRange(u.vendor))??{min:5,max:10},g=this.randomDelay(o.min,o.max);await this.sleep(g)}}async validateSingle(c,u,o){try{const g=await this.rest.validateVps(c,u);this.logPanel.push(`${o}Ôºö${c} ${u} -> ${g.available?"Âú®Á∫ø":"ÂîÆÁΩÑ"} (${g.message})`),this.applyStatus(c,u,g.available,g.message,g.checked_at)}catch(g){this.logPanel.push(`È™åËØÅ ${c} ${u} Â§±Ë¥•Ôºö${g.message}`,"error")}}applyStatus(c,u,o,g,s){var n;const $=`${c}-${u}`,x=this.vpsContainer.querySelector(`[data-key="${$}"]`);if(x){x.classList.toggle("asv-card--offline",!o);const V=x.querySelector(".asv-status-pill");V&&(V.textContent=o?"Âú®Á∫ø":"Â∑≤ÂîÆÁΩÑ",V.className=`asv-status-pill ${o?"asv-status-pill--up":"asv-status-pill--down"}`),(n=x.querySelector(".asv-soldout"))==null||n.remove()}const w=this.currentVps.find(V=>V.vendor===c&&V.pid===u);w&&(w.available=o,w.message=g,w.checked_at=s??Date.now()/1e3)}async runDiagnostics(){try{const c=await this.rest.runDiagnostics();this.renderDiagnostics(c)}catch(c){this.logPanel.push(`ËØäÊñ≠Â§±Ë¥•Ôºö${c.message}`,"error")}}renderDiagnostics(c){this.logPanel.push(`ÁΩëÁªúÔºö${c.network.ok?"Ê≠£Â∏∏":"ÂºÇÂ∏∏"} - ${c.network.message}`),this.logPanel.push(`LLMÔºö${c.llm.ok?"Â∞±Áª™":"ÂºÇÂ∏∏"} - ${c.llm.message}`)}applyExtraCss(c){const u=(c||"").trim();if(!u){this.extraCssNode&&(this.extraCssNode.remove(),this.extraCssNode=void 0);return}if(!this.extraCssNode){const o=document.createElement("style");o.dataset.source="asv-extra-css",document.head.appendChild(o),this.extraCssNode=o}this.extraCssNode.textContent=u}randomDelay(c,u){const o=u-c;return(c+Math.random()*o)*1e3}sleep(c){return new Promise(u=>{window.setTimeout(u,c)})}}let je=!1,me,Re;const re=()=>{const E=window.ASV_BOOTSTRAP;if(!E)return je||(console.warn("AutoSaleVPS: Áº∫Â∞ëÂàùÂßãÂåñÊï∞ÊçÆ"),je=!0),!1;je=!1;const c=Array.from(document.querySelectorAll(".asv-root"));return c.length?(c.forEach(u=>{if(u.dataset.asvMounted==="true")return;new _r(u,E).init(),u.dataset.asvMounted="true"}),!0):!1},kr=()=>{if(window.__ASV_PJAX_BRIDGE__)return;window.__ASV_PJAX_BRIDGE__=!0;const E=typeof window.pjaxLoaded=="function"?window.pjaxLoaded:void 0;window.pjaxLoaded=()=>{if(E)try{E.call(window)}catch(u){console.error("AutoSaleVPS: ÂÖ∂‰ªñ pjaxLoaded Èí©Â≠êÊâßË°åÂ§±Ë¥•",u)}re()};const c=window.jQuery||window.$;if(typeof c=="function"){const u=c(document);if(u&&typeof u.on=="function"){u.on("pjax:complete.autosalevps pjax:end.autosalevps",re);return}}document.addEventListener("pjax:complete",re)},Sr=()=>{document.readyState==="loading"&&document.addEventListener("DOMContentLoaded",()=>{re()},{once:!0}),window.addEventListener("load",()=>{re()})},Mr=()=>{if(Re||typeof MutationObserver>"u")return;const E=()=>{document.body&&(Re=new MutationObserver(c=>{for(const u of c)if(u.addedNodes.length){for(const o of Array.from(u.addedNodes))if(o instanceof HTMLElement&&(o.classList.contains("asv-root")||o.querySelector(".asv-root"))){re();return}}}),Re.observe(document.body,{childList:!0,subtree:!0}))};document.body?E():document.addEventListener("DOMContentLoaded",()=>{E()},{once:!0})},Nr=()=>{me||typeof window>"u"||(me=window.setInterval(()=>{window.ASV_BOOTSTRAP&&(me&&(window.clearInterval(me),me=void 0),re())},250))};Sr();Mr();kr();re()||Nr();
//# sourceMappingURL=main.js.map
